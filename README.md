[参考記事：Kaggle日記という戦い方(fkubotaさん)](https://zenn.dev/fkubota/articles/3d8afb0e919b555ef068) 

[Github(fkubotaさん)](https://github.com/fkubota/kaggle-Cornell-Birdcall-Identification)

# 製造業対抗データインサイトチャレンジ2025
- result
  - public: 
  - private: 
  - rank: /

## Overview
本コンペティションでは、架空の企業データセットを用いて、**各企業が 「業務プロセス改善DX商材」を導入するかどうか（導入=1, 非導入=0）を予測する二値分類モデル**を構築していただきます。

ご提供するデータセットには、企業の多面的な特徴を示す、以下のような合計42個の変数が含まれており、現実的な企業をイメージした内容になっています。(各カラムの詳細説明は、データタブより「description.csv」ファイルをダウンロードして確認してください。)

- 企業の基本情報：従業員数、業界、組織といった、企業の規模や性質を示す基本的なデータ。
- 財務三表データ：B/S（貸借対照表）、P/L（損益計算書）、C/F（キャッシュフロー計算書）からなる財務情報。
- 企業へのアンケート結果：企業文化やDXの現状、改善ニーズ、導入意欲に関する複数のアンケート結果。特に、自由記述形式のテキストデータが含まれており、現場の課題意識や改善要望といった定性的な意見も分析の対象となります。

## Dataset
### Shape
Train.csv: (742, 43) <br>
Test.csv: (800, 42) <br>
Submission.csv: (800, 2)

### Train.csv (742, 43)
| No | Name | dtype | Explanation |
|----|------|-------|-------------|
| 1  | 企業ID | int64 | 企業固有のNo |
| 2  | 企業名 | object | 架空の企業名 |
| 3  | 従業員数 | int64 | 連結従業員数 |
| 4  | 業界 | object | 製造、商社、金融、機械、アパレル、エネルギー、IT・・・等 |
| 5  | 上場種別 | object | マーケット名 |
| 6  | 取引形態 | object | BtoB,BtoCなど |
| 7  | 企業概要 | object | 企業の事業内容等 |
| 8  | 組織図 | object | 階層型組織図（フォーマットは統一されていない） |
| 9  | 事業所数 | float64 | 企業が保有する事務所の数 |
| 10 | 工場数 | float64 | 企業が保有する工場の数 |
| 11 | 店舗数 | float64 | 企業が保有する店舗の数 |
| 12 | 資本金 | float64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 13 | 総資産 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 14 | 流動資産 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 15 | 固定資産 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 16 | 負債 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 17 | 短期借入金 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 18 | 長期借入金 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 19 | 純資産 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 20 | 自己資本 | int64 | 貸借対照表科目（直近の年度末決算値）【単位：百万円】 |
| 21 | 売上 | int64 | 損益計算書科目（直近の年度末決算値）【単位：百万円】 |
| 22 | 営業利益 | float64 | 損益計算書科目（直近の年度末決算値）【単位：百万円】 |
| 23 | 経常利益 | float64 | 損益計算書科目（直近の年度末決算値）【単位：百万円】 |
| 24 | 当期純利益 | int64 | 損益計算書科目（直近の年度末決算値）【単位：百万円】 |
| 25 | 営業CF | int64 | キャッシュフロー計算書科目（直近の年度末決算値）【単位：百万円】 |
| 26 | 減価償却費 | int64 | キャッシュフロー計算書科目（直近の年度末決算値）【単位：百万円】 |
| 27 | 運転資本変動 | int64 | キャッシュフロー計算書科目（直近の年度末決算値）【単位：百万円】 |
| 28 | 投資CF | int64 | キャッシュフロー計算書科目（直近の年度末決算値）【単位：百万円】 |
| 29 | 有形固定資産変動 | int64 | キャッシュフロー計算書科目（直近の年度末決算値）【単位：百万円】 |
| 30 | 無形固定資産変動(ソフトウェア関連) | int64 | キャッシュフロー計算書科目（直近の年度末決算値）【単位：百万円】 |
| 31 | アンケート１ | int64 | 【質問内容】DX推進の戦略的な方向性はどの程度明確ですか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 32 | アンケート２ | int64 | 【質問内容】社内のDX化に対する満足度はどの程度ですが？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 33 | アンケート３ | int64 | 【質問内容】最新デジタル技術（クラウド、AI、IoT等）の導入状況はどの程度進んでいますか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 34 | アンケート４ | int64 | 【質問内容】社内のDX変革に対する抵抗感はどの程度ありますか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 35 | アンケート５ | int64 | 【質問内容】サイバーセキュリティ対策の整備状況はどの程度十分ですか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 36 | アンケート６ | int64 | 【質問内容】すでに業務プロセスの改善や自動化を目的としたツールやサービスを導入していますか？(1:はい, 2:いいえ) |
| 37 | アンケート７ | float64 | 【質問内容】アンケート6が「はい」の場合、既存の業務プロセス改善ツールやサービスに対する満足度はどの程度ですか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 38 | アンケート８ | int64 | 【質問内容】DXプロジェクトの成果や効果はどの程度実感されていますか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 39 | アンケート９ | int64 | 【質問内容】新技術イベントやセミナーへの参加率はどの程度高いですか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 40 | アンケート１０ | int64 | 【質問内容】外部パートナー（ベンダー、コンサルタント等）とのDX連携実績はどの程度充実していますか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 41 | アンケート１１ | int64 | 【質問内容】DXに関する最新技術やツールの導入状況について、どの程度の情報収集を行っていますか？(1: 非常に低い, 2:低い, 3: 普通, 4:高い, 5: 非常に高い) |
| 42 | 今後のDX展望 | object | 【質問内容】御社の今後のDX投資に関する方向性や計画について、ぜひお話をお聞かせいただけますか？ |
| 43 | 購入フラグ | int64 | 0＝未購入, 1＝購入 |

### Test.csv (800, 42)

### Submission.csv　(800, 2)
| 企業ID | 購入フラグ（0＝未購入, 1＝購入） |
|--------|----------------------------------|
| 742    | 1                                |
| 743    | 0                                |
| ...    | ...                              |
| 1540   | 1                                |
| 1541   | 0                                |

## データ分析
### 分析結果と前処理
- 「業界」ごとに購入傾向が異なる
- 　"専門サービス"と"その他"業界の２データをTrain.csvから除外
  - len(train['業界'].unique())　-> 31
  - len(test['業界'].unique()) -> 29 (**'専門サービス'と'その他'はTestには存在しない**)
- 「取引形態」が"BtoB, BtoC, CtoC", "CtoC"となっているのはTrain.csvに各1件のため除外
### 「業界」と「平均購入確率」
<img width="1189" height="691" alt="image" src="https://github.com/user-attachments/assets/07334efb-5a3f-4dd8-8286-15df7b219acb" />

### 「取引形態」
#### 取引形態（Train.csv）
BtoB                441
BtoB, BtoC          220
BtoC                 77
BtoB, BtoC, CtoC      1
CtoC                  1

#### 取引形態（Test.csv）
BtoB          474
BtoB, BtoC    257
BtoC           66

## Pipeline
- 実行例
  ```bash
  python3 pipeline.py --globals.balanced=1 --globals.comment=test
  ```

- 結果の表示例
  ```bash
  python3 show_result.py -d 0
  ```
  
## Log
### 20251019
- join!!
- 一通り完成させたものの、スコア0.51
- エラー：[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
- 原因１：クラスの不均衡
  - 0（未購入）:563, 1（購入）:179
  - 正例が少なく、負例（未購入）が多い
  - 対策：パラメータに is_unbalance=True または
  - 対策：scale_pos_weight = 563 / 179 ≈ 3.15 を設定。
- 原因２：特徴量が多すぎる
  - 上位20〜30個の重要な特徴量に絞ると分岐が作りやすくなる。（もっと少なくても良いかも）
  
-Submit -> 0.495（なんで...? 学習時のエラーも解消されたけど。）
  - 特徴量数減少
  - 目的変数の不均衡対策
  - 特徴量の重要度表示
-TODO: **学習時の特徴量寄与・TF-IDFの上位の単語を確認**
### 2025


## コンペ反省会
|著者|Ref|
|---|---|
